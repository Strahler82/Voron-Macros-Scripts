[gcode_macro ADXL_QUERY]
description: adxl preflight
gcode:
  SET_IDLE_TIMEOUT TIMEOUT={ 60 * 60 }
  CHECK_QGL
  G90
  G0 X173 Y175 Z30 F20000
  ACCELEROMETER_QUERY
  MEASURE_AXES_NOISE 
  RESPOND MSG="stepper fan off?" TYPE=error


[gcode_macro ADXL_TEST_X]
description: measure resonance on x
gcode:
  STATUS_OFF
  TEST_RESONANCES AXIS=X OUTPUT=raw_data
  STATUS_OK
  RESPOND MSG="stepper fan off?" TYPE=error


[gcode_macro ADXL_TEST_Y]
description: measure resonance on y
gcode:
  STATUS_OFF
  TEST_RESONANCES AXIS=Y OUTPUT=raw_data
  STATUS_OK
  RESPOND MSG="stepper fan off?" TYPE=error


[gcode_macro ADXL_GOTO_150]
description: position for 150mm 100hz test
gcode:
  STATUS_OFF
  G90
  G0 X173 Y110 Z30 F20000
  RESPOND MSG="stepper fan off?" TYPE=error


[gcode_macro ADXL_TEST_BELTS]
description: measure both axes for belt tension
gcode:
  ADXL_TEST_B
  ADXL_TEST_A


[gcode_macro ADXL_TEST_B]
description: measure B axis
gcode:
  STATUS_OFF
  M118 measuring B (front left -> back right)...
  TEST_RESONANCES AXIS=1,1 OUTPUT=raw_data NAME=B
  STATUS_OK
  RESPOND MSG="stepper fan off?" TYPE=error

[gcode_macro ADXL_TEST_A]
description: measure A axis
gcode:
  STATUS_OFF
  M118 measuring A (front right -> back left)...
  TEST_RESONANCES AXIS=1,-1 OUTPUT=raw_data NAME=A
  STATUS_OK
  RESPOND MSG="stepper fan off?" TYPE=error

[gcode_macro ADXL_TEST_ALL]
description: measure everything for tap
gcode:
  STATUS_OFF
  TEST_RESONANCES AXIS=X OUTPUT=raw_data FREQ_END=130
  TEST_RESONANCES AXIS=Y OUTPUT=raw_data FREQ_END=130
  TEST_RESONANCES AXIS=1,1 OUTPUT=raw_data NAME=B FREQ_END=130
  TEST_RESONANCES AXIS=1,-1 OUTPUT=raw_data NAME=A FREQ_END=130
  STATUS_OK
  RESPOND MSG="stepper fan off?" TYPE=error


[gcode_macro DISABLE_PRESSURE_ADVANCE]
description: disable pressure advance and smooth time
gcode:
  SET_PRESSURE_ADVANCE ADVANCE=0 SMOOTH_TIME=0
