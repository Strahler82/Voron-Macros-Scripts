[gcode_macro PROBE_CORNERS]
description: 
gcode:

  {% set points = ([75, 75], [75, 275], [275, 275], [275, 75]) %}

  M107

  {% for i in range(5) %}

    M118 starting run {i}
    G28
    QUAD_GANTRY_LEVEL
    G28
    CENTER

    {% for p in points %}
      {% set offset_x = range(-2, 2) | random %}
      {% set offset_y = range(-2, 2) | random %}

      {% set x = p[0] + offset_x %}
      {% set y = p[1] + offset_y %}
      M118 { "probe accuracy results run %d for point: %.1f, %.1f" % (i, p[0], p[1]) }
      PROBE_ACCURACY SAMPLES=100
    {% endfor %}
  {% endfor %}

  CENTER


[gcode_macro PROBE_BREAK_IN]
description: 
gcode:
  {% set HOTEND = params.HOTEND | default(0, True) | int %}
  {% set BED = params.BED | default(0, True) | int %}
  {% set CHAMBER = params.CHAMBER | default(0, True) | int %}
  {% set cooldown = 0 %}

  {% if CHAMBER %}
    {% set HOTEND = 1 %}
    {% set BED = 1 %}
    {% set cooldown = 1 %}
  {% endif %}

  {% if HOTEND %}
    {% set cooldown = 1 %}
    M104 S150
  {% endif %}

  {% if BED %}
    {% set cooldown = 1 %}
    M140 S110
  {% endif %}

  {% if CHAMBER %}
    CHAMBER_INIT
  {% endif %}

  {% set SAMPLES = 100 %}

  {% set center_x = (printer.toolhead.axis_maximum.x/2)|int %}
  {% set center_y = (printer.toolhead.axis_maximum.y/2)|int %}

  M118 using center {center_x}, {center_y}

  {% set start_x = range((center_x - 20), (center_x + 20)) | random %}
  {% set start_y = range((center_y - 20), (center_y + 20)) | random %}

  M118 random center {start_x}, {start_y}

  {% set points = ([0, 50], [29.4, 40.5], [47.6, 15.5], [47.6, -15.5], [29.4, -40.5], [0, -50], [-29.4, -40.5], [-47.6, -15.5], [-47.6, 15.5], [-29.4, 40.5]) %}

  G28
  QUAD_GANTRY_LEVEL
  G28
  CENTER
  M107

  {% for p in points %}
    {% set x = (p[0] + start_x) %}
    {% set y = (p[1] + start_y) %}
    M118 { "probe accuracy results for point: %.1f, %.1f" % (x, y) }
    PROBE_ACCURACY SAMPLES={SAMPLES}
  {% endfor %}

  {% if cooldown %}
    COOLDOWN
  {% endif %}

  CENTER
