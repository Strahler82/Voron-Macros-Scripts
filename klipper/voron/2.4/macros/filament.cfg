[gcode_macro FILAMENT_OVERRIDES]
description: useful per-filament settings, called from SuperSlicer
gcode:
  {% set MATERIAL = params.MATERIAL | default("ABS") %}
  {% set BRAND = params.BRAND | default("Default") %}
  {% set COLOR = params.COLOR | default("Black") %}

  {% if 'Default' in BRAND %}

  {% elif 'Paramount' in BRAND %}

  {% endif %}


[gcode_macro FILAMENT_RUNOUT]
description: filament runout event
gcode:
  { action_respond_info("filament runout triggered") }
  NOTIFY MSG="filament runout triggered"
  DISABLE_FILAMENT_SENSOR
  PAUSE


[gcode_macro ENABLE_FILAMENT_SENSOR]
description: enable filament runout sensor
gcode:
  SET_FILAMENT_SENSOR SENSOR=filament ENABLE=1

[gcode_macro DISABLE_FILAMENT_SENSOR]
gcode:
  SET_FILAMENT_SENSOR SENSOR=filament ENABLE=0


[gcode_macro FILAMENT_LOAD]
description: slow load 75mm of filament
gcode:
  SAVE_GCODE_STATE NAME=__filament__load
  M83
  G1 E50 F240
  G1 E25 F240
  RESTORE_GCODE_STATE NAME=__filament__load

[gcode_macro FILAMENT_UNLOAD]
description: fast unload 100mm of filament 
gcode:
  SAVE_GCODE_STATE NAME=__filament__load
  M83
  G1 E-50 F960
  G1 E-50 F960
  RESTORE_GCODE_STATE NAME=__filament__load

[gcode_macro FILAMENT_PURGELOAD]
description: heat extruder to 225 then FILAMENT_LOAD
gcode:
  {% if printer[printer.toolhead.extruder].temperature <= 225 %}
    M109 S{225}
  {% endif %}

  FILAMENT_LOAD
