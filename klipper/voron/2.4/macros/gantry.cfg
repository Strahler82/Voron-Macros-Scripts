[gcode_macro QGL]
description: QGL
gcode:
  BED_MESH_CLEAR
  G28
  QUAD_GANTRY_LEVEL
  G28
  GET_POSITION


[gcode_macro CHECK_GQL]
description: only QGL if required
gcode:
  {% if printer.quad_gantry_level.applied == False %}
    QGL
  {% endif %}


[gcode_macro G32]
gcode:
  QGL


[gcode_macro RAISE_BACK]
description: attempt to offset rear gantry sag for easier QGL
gcode:
  {% for i in range(params.TIMES | default(2) | int) %}
    FORCE_MOVE STEPPER=stepper_z1 DISTANCE=2 VELOCITY=5
    FORCE_MOVE STEPPER=stepper_z2 DISTANCE=2 VELOCITY=5
  {% endfor %}
